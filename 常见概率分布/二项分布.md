# 二项分布

## 定义

二项分布是一种离散概率分布，描述了n次独立的是/否试验中成功次数的概率分布，其中每次试验成功的概率为p。如果随机变量X服从参数为n和p的二项分布，记作：X ~ B(n, p) 或 X ~ Bin(n, p)。

## 场景

1. **硬币抛掷**：n次硬币抛掷中出现正面的次数
2. **质量控制**：从生产线上随机抽取n个产品，其中有缺陷的数量
3. **医学试验**：n名患者中对某种治疗有反应的人数
4. **民意调查**：在n个受访者中支持某一政策的人数
5. **风险评估**：n个独立系统中故障系统的数量
6. **遗传学**：n个后代中具有特定基因的数量
7. **市场营销**：n个顾客中购买产品的人数

## 公式

### 分布函数

二项分布的累积分布函数为：

F(k;n,p)=P(X≤k)=∑i=0k(ni)pi(1−p)n−iF(k; n, p) = P(X \leq k) = \sum_{i=0}^{k} \binom{n}{i} p^i (1-p)^{n-i}F(k;n,p)=P(X≤k)=∑i=0k​(in​)pi(1−p)n−i

### 密度函数

二项分布的概率质量函数为：

P(X=k)=(nk)pk(1−p)n−kP(X = k) = \binom{n}{k} p^k (1-p)^{n-k}P(X=k)=(kn​)pk(1−p)n−k

其中：

- (nk)=n!k!(n−k)!\binom{n}{k} = \frac{n!}{k!(n-k)!}(kn​)=k!(n−k)!n!​ 是二项式系数
- kkk 是成功次数，范围是 0≤k≤n0 \leq k \leq n0≤k≤n
- ppp 是单次试验成功概率，范围是 0≤p≤10 \leq p \leq 10≤p≤1

## 图像

二项分布的图像形状取决于其参数：

- 当 p=0.5p = 0.5p=0.5 时，分布关于 k=n/2k = n/2k=n/2 对称
- 当 p<0.5p < 0.5p<0.5 时，分布右偏（正偏度）
- 当 p>0.5p > 0.5p>0.5 时，分布左偏（负偏度）
- 随着 nnn 的增大，分布的形状越来越接近正态分布

## 特征

对于 X∼B(n,p)X \sim B(n, p)X∼B(n,p)，主要统计特性有：

1. **期望值**：E(X)=npE(X) = npE(X)=np
2. **方差**：Var(X)=np(1−p)Var(X) = np(1-p)Var(X)=np(1−p)
3. **标准差**：σ=np(1−p)\sigma = \sqrt{np(1-p)}σ=np(1−p)​
4. **众数**：Mode(X)=⌊(n+1)p⌋Mode(X) = \lfloor (n+1)p \rfloorMode(X)=⌊(n+1)p⌋ 或 ⌈(n+1)p⌉−1\lceil (n+1)p \rceil - 1⌈(n+1)p⌉−1（当 (n+1)p(n+1)p(n+1)p 不是整数时）
5. **偏度**：Skewness(X)=1−2pnp(1−p)Skewness(X) = \frac{1-2p}{\sqrt{np(1-p)}}Skewness(X)=np(1−p)​1−2p​
6. **峰度**：Kurtosis(X)=3+1−6p(1−p)np(1−p)Kurtosis(X) = 3 + \frac{1-6p(1-p)}{np(1-p)}Kurtosis(X)=3+np(1−p)1−6p(1−p)​
7. **特征函数**：ϕX(t)=(1−p+peit)n\phi_X(t) = (1-p+pe^{it})^nϕX​(t)=(1−p+peit)n
8. **矩母函数**：MX(t)=(1−p+pet)nM_X(t) = (1-p+pe^t)^nMX​(t)=(1−p+pet)n

## 与其它分布关系

1. **二项分布与伯努利分布**：当 n=1n = 1n=1 时，二项分布简化为伯努利分布
2. **二项分布与泊松分布**：当 n→∞n \to \inftyn→∞，p→0p \to 0p→0，且 np=λnp = \lambdanp=λ 保持固定时，二项分布趋近于参数为 λ\lambdaλ 的泊松分布
3. **二项分布与正态分布**：根据中心极限定理，当 nnn 足够大时，标准化的二项随机变量近似服从标准正态分布
4. **二项分布与负二项分布**：负二项分布描述达到r次成功所需的试验总次数
5. **二项分布与超几何分布**：超几何分布是不放回抽样情况下的类似分布

## 推广

1. **负二项分布**：扩展为达到特定成功次数所需的试验次数
2. **Beta-二项分布**：将成功概率p视为来自Beta分布的随机变量
3. **多项分布**：扩展到具有两个以上可能结果的试验
4. **Poisson-二项分布**：每次试验的成功概率可能不同的二项分布推广

## 要点

1. **加性**：如果 X∼B(n,p)X \sim B(n, p)X∼B(n,p) 且 Y∼B(m,p)Y \sim B(m, p)Y∼B(m,p) 是独立的，则 X+Y∼B(n+m,p)X + Y \sim B(n+m, p)X+Y∼B(n+m,p)
2. **条件分布**：如果 X∼B(n,p)X \sim B(n, p)X∼B(n,p) 且 Y∼B(m,p)Y \sim B(m, p)Y∼B(m,p) 且总和 S=X+YS = X + YS=X+Y 已知，则 XXX 的条件分布是超几何分布
3. **共轭先验**：在贝叶斯推断中，Beta分布是二项分布成功概率p的共轭先验
4. **二项定理关系**：二项分布的名称来源于二项式定理 (a+b)n=∑k=0n(nk)akbn−k(a+b)^n = \sum_{k=0}^{n} \binom{n}{k} a^k b^{n-k}(a+b)n=∑k=0n​(kn​)akbn−k
5. **对称性**：如果 X∼B(n,p)X \sim B(n, p)X∼B(n,p)，则 n−X∼B(n,1−p)n-X \sim B(n, 1-p)n−X∼B(n,1−p)

## 计算技巧

1. **递归计算**：可以使用递归关系计算二项概率  
    P(X=k+1)=P(X=k)⋅n−kk+1⋅p1−pP(X = k+1) = P(X = k) \cdot \frac{n-k}{k+1} \cdot \frac{p}{1-p}P(X=k+1)=P(X=k)⋅k+1n−k​⋅1−pp​
    
2. **对数转换**：计算大数字时，使用对数形式避免数值溢出  
    log⁡P(X=k)=log⁡(nk)+klog⁡p+(n−k)log⁡(1−p)\log P(X = k) = \log \binom{n}{k} + k \log p + (n-k) \log(1-p)logP(X=k)=log(kn​)+klogp+(n−k)log(1−p)
    
3. **正态近似**：当 nnn 大且 ppp 不太接近0或1时，可使用正态近似  
    X≈N(np,np(1−p))X \approx N(np, np(1-p))X≈N(np,np(1−p))
    
    应用连续性校正：P(X≤k)≈P(Z≤k+0.5−npnp(1−p))P(X \leq k) \approx P(Z \leq \frac{k+0.5-np}{\sqrt{np(1-p)}})P(X≤k)≈P(Z≤np(1−p)​k+0.5−np​)
    
4. **泊松近似**：当 nnn 大且 ppp 小时，可使用泊松近似  
    P(X=k)≈e−λλkk!P(X = k) \approx \frac{e^{-\lambda}\lambda^k}{k!}P(X=k)≈k!e−λλk​
    
    其中 λ=np\lambda = npλ=np
    

## 注意事项

1. **独立性假设**：二项分布假设每次试验是独立的，现实中这一假设可能不成立
2. **不变成功概率**：二项分布假设每次试验的成功概率相同，如果不同则需使用Poisson-二项分布
3. **大数计算**：对于大的n值，直接计算二项式系数可能导致数值溢出，需采用特殊算法
4. **连续性校正**：使用正态分布近似二项分布时，应进行连续性校正
5. **小样本情况**：当样本量小时，正态近似和泊松近似的效果可能不佳
6. **参数估计**：从数据估计p时，其置信区间与n和p的值有关
7. **零和一的概率**：当p接近0或1时，某些事件的概率可能非常小，需特别处理