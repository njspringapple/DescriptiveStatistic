我们如何从观测数据中对特征之间的（不）独立性做出判断


- 特征（X，Y，Z）的观测值（xi，yi，zi）
- 数据形式（x1，y1，z1），。。。，（xn，yn，zn）

**研究：**

- **X和Y之间如何关联 ？**
- **X和Y是独立的吗？**
- **X如何影响Y？**

### 列联表

- **绝对频数**：列联表以绝对频数的形式反映了特征 X 和 Y 的**联合分布**
- **相对频数**  相对频数列联表的优势是能更直观地展示各类别组合的占比关系，便于跨样本或跨研究的比较（不受总样本量差异的影响）

列联表通过绝对频数的形式，完整呈现了特征X和Y的**联合分布**（即两个特征所有可能组合的出现次数）。边缘频数则是联合分布在单个特征上的 “投影”，反映了每个特征单独的分布情况。

### 条件频率

从联合频数\(h_{ij}\)或联合相对频率\(f_{ij}\)中，**很难直接看出特征X与Y之间的关联。**

因此，我们需要关注**条件频率**：  
⟹ **即当另一个特征取固定值时，某一特征的分布情况。**

**记忆要点：**  
条件频率分布是通过将联合频数 \(h_{ij}\) 或联合频率 \(p_{ij}\) 除以相应的行总和或列总和得到的。

### 离散相关分析（优势比）

条件比值 Odds 和 比值比 OR

比值比通过对比两组的 “事件发生与不发生的相对可能性”，清晰量化了两个分类变量之间的关联强度。

#### 病例 - 对照研究中 OR 的意义

在病例 - 对照研究中，由于无法直接计算发病率（因病例和对照是人为选择的，而非自然人群），比值比（OR）成为衡量关联强度的核心指标。当疾病发生率较低时，OR 可近似替代相对风险（RR），直观反映 “暴露因素（如 ApoE4）与疾病（如阿尔茨海默病）的关联强度”。

  

本例中 OR=6，意味着携带 ApoE4 的人群相对于携带 ApoE3 的人群，患阿尔茨海默病的 “相对风险” 约为 6 倍，关联强度较高。
### 推广到 \(I \times J\) 列联表的说明

▶ **将方法推广到至少一个特征具有两个以上取值的情况**： 可以通过每次限定两行（\(X = x_i\) 和 \(X = x_k\)）和两列（\(Y = y_j\) 和 \(Y = y_l\)），并关注 \(I \times J\) 列联表中对应的四个单元格来实现。

  

▶ **参考类别的使用** 在多类别情况下，通常会选择一个类别作为 “参考类别”（如某一特定的教育水平、疾病状态等），通过与参考类别的对比来计算比值比，从而清晰呈现不同类别间的关联差异。

  

▶ **对数比值比的应用** 实际分析中，常使用**对数比值比（logarithmierte Odds Ratio）** 替代原始比值比。这是因为对数转换可将比值比的乘法关系转化为加法关系，便于进行统计建模（如 logistic 回归）和假设检验，同时能使数据分布更接近正态分布，简化分析过程。


临床对照组计算OR来支持某一个风险因素

### 离散相关性分析：独立性与列联

**经验不独立**
### 列联表与卡方系数（\(\chi^2\)-Koeffizient）

核心思路：

  

1. 若在给定边缘分布的情况下，特征X和Y“经验独立”，那么**联合频数**\(\tilde{h}_{ij}\)或**联合概率**\(\tilde{p}_{ij}\)会呈现怎样的形式？
2. 量化**观测到的联合频数**与**假设独立时的期望联合频数**之间的 “距离”。


经验独立性是随机独立性在样本数据中的体现 —— 通过样本的条件相对频率是否一致来判断两个特征在观测数据中是否无关联。

比值比 = 1 是独立性的标志

卡方系数（\(\chi^2\)-Koeffizient）的计算公式为 

### 卡方系数（\(\chi^2\)-Koeffizient）的性质

▶ \(\chi^2 \in [0, n(\min(I, J) - 1)]\) （其中n为样本量，I、J分别为列联表的行数和列数）

  

▶ \(\chi^2 = 0 \iff\) 特征X和Y经验独立 （即观测频数与独立假设下的期望频数完全一致）

  

▶ \(\chi^2\)值大 \(\iff\) 关联强度高 （观测值与期望值的整体偏离显著，特征间关联密切）

  

▶ \(\chi^2\)值小 \(\iff\) 关联强度低 （观测值与期望值的偏离轻微，特征间关联较弱）

### 局限性

卡方系数的取值范围**依赖于样本量n和列联表的维度**（行数和列数）。例如：

  

- 大样本量可能导致\(\chi^2\)值偏大，即使关联强度实际较弱；
- 表格维度不同（如 2×2 表 vs 5×5 表）时，\(\chi^2\)的绝对数值无法直接比较。

  

因此，\(\chi^2\)的数值本身难以直接解读关联的实际强度


期望频数，卡方分量，卡方系数 的计算

### 卡方系数（\(\chi^2\)-Koeffizient）的性质

▶ \(\chi^2 \in [0, n(\min(I, J) - 1)]\) （其中n为样本量，I、J分别为列联表的行数和列数）

  

▶ \(\chi^2 = 0 \iff\) 特征X和Y经验独立 （即观测频数与独立假设下的期望频数完全一致）

  

▶ \(\chi^2\)值大 \(\iff\) 关联强度高 （观测值与期望值的整体偏离显著，特征间关联密切）

  

▶ \(\chi^2\)值小 \(\iff\) 关联强度低 （观测值与期望值的偏离轻微，特征间关联较弱）

列联系数的计算公式为：xxxx      - 列联系数是对卡方系数（\(\chi^2\)）的标准化处理，消除了样本量（n）对结果的影响，使不同研究的关联强度更具可比性。

**修正列联系数**：xxxx   - 修正列联系数进一步将取值范围规范至 [0, 1]，其中 0 表示完全独立，1 表示完全关联，更便于直观解读关联强度。

▶ （修正）列联系数仅衡量关联的强度，而不像比值比（Odds Ratio）那样反映关联的方向。

  

▶ 当对比单元格数量相同但样本量差异显著的列联表时，需谨慎解读结果：因为卡方值（\(\chi^2\)）会随样本量增大而增大。例如，若观测频数（\(h_{ij}\)）和期望频数（\(\tilde{h}_{ij}\)）均扩大 10 倍，卡方值也会扩大 10 倍（进而影响列联系数）。

  

▶ 所有这些度量指标（列联系数、修正列联系数）仅利用了变量X和Y的**名义尺度水平**（即仅关注类别归属，不涉及等级或数值大小）。

### 多变量列联表与马赛克图

多维列联表用于分析**多个离散特征**之间的关联

### 马赛克图（Mosaik-Plot）

▶ **联合频数的面积忠实呈现**  
马赛克图通过**矩形的面积大小**，精确反映列联表中各单元格的联合频数（或频率），面积越大，对应类别的样本量越多。


▶ **分步拆分方式**  
图形的拆分遵循 “先按影响因素，再按目标变量” 的逻辑逐步进行：

  

- 首先根据一个自变量（如 “性别”）将整体区域拆分为不同宽度的矩形，宽度对应该变量各类别的边缘频率；
- 再在每个矩形内部，按另一个变量（如 “生还情况”）拆分为不同高度的子矩形，高度对应条件频率；
- 多维度时可进一步嵌套拆分（如在 “性别”“生还情况” 基础上，再按 “舱位等级” 拆分）。

  

▶ **适用于多类别有序数据**  
对于包含多个类别且具有顺序关系的数据（如 “学历：小学 < 初中 < 高中 < 大学”），马赛克图能通过拆分顺序直观体现类别间的层级关联。

  

▶ **理论上适用于更高维度**  
虽然马赛克图可通过多层嵌套展示三个及以上变量的关系（例如 “性别→舱位等级→年龄组→生还情况”），但维度过高时可能因图形复杂而难以解读。

  

▶ **二维情况下的等价形式**  
对于两个维度的变量，马赛克图相当于**具有可变宽度的堆叠条形图**：

  

- 条形的宽度对应第一个变量的边缘频率（类似普通条形图的 “组距”）；
- 条形内部的堆叠高度对应第二个变量的条件频率（类似堆叠条形图的 “组内占比”）。

  

马赛克图的核心优势在于：能同时展示多个分类变量的联合分布和关联模式，比单纯的数字表格更直观地揭示变量间的交互影响（如泰坦尼克号案例中 “性别 + 舱位” 对生还率的共同作用）


一般三个维度，**宽度，高度，颜色**

