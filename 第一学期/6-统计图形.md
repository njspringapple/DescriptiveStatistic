
统计图形是：通过 **几何对象** （geometrischer Objekte）的 **美学特征**（ästhetischen Eigenschaften） 来呈现 **数据集中** 某些特征的表现形式，我们可以推导出图形表示的一种正式 “语法”（“Grammatik）。
#### 1. 图形语法（Grammar of Graphics）

每一个有意义的图形都可以描述为以下基本元素的组合：

- **数据**：包含所呈现特征的观测值  
    （通常也包括：由数据推导出来的统计量，如比例、平均值等）
- **几何元素**（Geometrien）：例如点、线、矩形等……
- **美学映射（Ästhetiken）**：图形中所呈现特征的表现形式，通过几何元素的可见特征来体现，例如：
    - 位置（垂直 / 水平）position
    - 颜色 color
    - 大小 size
    - 形状 shape
    - 线宽 line width
    - 线型 line style

**数据转换 / 统计量**：通常呈现的 **不是原始数据本身**，而是由其**推导出来的量**（平均值、比例……），更复杂的几何元素往往内部基于数据转换（→ 柱状图、平滑趋势线、箱线图……）。

**标度**（Skalen）为给定的特征 / 统计量及其美学映射，为每一种表现形式分配特定的值（例如，**位置对应的轴线分段、颜色对应的色彩 palette 等**），并由此确定图例（**例如颜色标度的图例**）和轴标签

**坐标系**（Koordinatensysteme）：笛卡尔坐标系（kartesische） / 对数坐标系（logarithmische） / 极坐标系（Polarkoordinatensysteme）；地图投影（Kartenprojektionen）

**分面**（Facettierung）：定义**根据哪些特征将数据划分为子组**，以及不同子组的图形**如何排列**（参见：小多幅图、网格图）。

**主题**（Theme）：包含所有设计方面的内容，如字体特征、网格线、背景颜色、文本元素和图例的布局等……

**几何元素实例**：点，柱状，折线，面积，多边形，栅格，路径
#### 0. 图形：感知（Graffiken: Wahrnehmung）

感知心理学实验表明，在对以下图形类型的正确解读方面存在显著差异：

正确解读的层级关系：

1. 位置（共用 / 平行标度 > 错位标度）Position (gemeinsame/parallele Skala > verschobene Skalen)
2. 距离与长度（Abstände & Längen）
3. 斜率与角度（Steigung & Winkel）
4. 面积（Flächen）
5. 体积（Volumen）
6. 色调 - 饱和度 - 明度（Farbton-Farbsättigung-Farbhelligkeit）
#### 1. 卓越图形的原则（Principles of Graphical Excellence）

- 卓越的图形是对有趣数据的精心呈现 —— 关乎实质内容、统计逻辑与设计美感。
- 卓越的图形能够以**清晰（precision）、精准且高效（efffciency）**的方式传递复杂思想。
- 卓越的图形能让观者在**最短时间内**（shortest time），通过**最少的笔墨**（least ink）和**最小的空间**（smallest space）获取最多的信息。
- 卓越的图形几乎总是 **多变量的**（multivariate）（即同时呈现多个变量的关联）。
- 此外，卓越的图形必须如实反映**数据的真相**（telling the truth about the data）

#### 2. 图形设计的黄金法则（Goldene Regeln für Grafikgestaltung）

- 对图形的理解需要以下三个阶段：
    
    - **识别（Detektion）**：明确哪些 **几何元素** 和 **美学特征** 代表 **哪些数值**。
    - **整合（Synthese）**：对识别出的内容进行 **分组**，并建立相互关联。
    - **评估（Evaluation）**：判断这些内容的 **相对大小和重要性**。  
        具体而言：包括 区分差异、排序分级、估算比例关系。
        
- 这三个阶段都需要通过有意识的选择来辅助：
    
    - 合适的 **美学映射**（Ästhetiken） 与 **几何元素**（Geometrien）（如前文所述：距离 > 颜色等）。
    - 合适的 **坐标轴**（Achsen）、**网格线**（Gitterlinien） 和 **纵横比例**（Seitenverhältnisse）。
    - 对定性特征的表现形式进行内容上恰当的 **排序**（Sortierung） / **排列**（Reihenfolge）。
    - 相应的**注释与强调**（Annotationen & Hervorhebungen）

#### 3. 图形：信息可视化 vs 统计图形（Infoviz vs Statistische Graffken）

美学映射的感知 通过以下方式对信息进行编码 ：

- 位置、长度与距离：**最容易被识别**，尤其对于共用 / 平行标度而言
- 角度与斜率：视觉印象取决于方向和图示的宽高比
- 面积：
    - 狭长的面积看起来比紧凑 / 凸形的面积更大
    - 受颜色影响：**浅色的面积给人更大的感觉**
- 颜色：**通常难以精确读取对比**
- 尽管如此，（颜色）仍十分普遍，因为它可以与其他图形元素结合使用
#### 4. 颜色尺度（Farbskalen）

##### 4.1 颜色感知（Farbwahrnehmung）

- 颜色感知**十分复杂**
- 为图形选择颜色时，需考虑 **感知的一致性**（Wahrnehmungseinheitlichkeit）：
    - 感知一致性的核心**是让视觉元素的 “感知效果” 与 “信息含义” 形成稳定、可预测的对应关系，减少解读偏差**
    - 在饱和度（Sättigung）相同的情况下，**绿色 / 黄色调比其他颜色给人的感觉更强烈。**
    - **需考虑色觉缺陷问题**（Sehschwächen mitbedenken）红绿色觉缺陷（红绿色盲）Rot-Grün-Sehschwäche 是视觉缺陷中最常见的类型 -- 避免使用**红绿色**
##### 4.2 色彩空间（Farbräume）

- **“技术性” 色彩空间**：
    
    - RGB（红 - 绿 - 蓝，适用于屏幕显示）
    - CMYK（青 - 品红 - 黄 - 黑，适用于印刷）

像 **RGB/CMYK** 这类**加色混合**的色彩空间（Additive Farbräume），**其原理与人类的色彩感知机制并不匹配**，因此还存在以下色彩空间

- **HCL**：色相（hue）- 彩度（chroma）- 明度（luminance）
- **HSV**：色相（hue）- 饱和度（saturation）- 明度（value）
- **Lab**：明度（Lightness）- a 轴（绿 - 红轴）- b 轴（蓝 - 黄轴）


- **色相（hue / Farbton）**：主管波长（Wellenlänge），不同波长是不同的颜色
- **饱和度（chroma / Farbsättigung）** ： 反映了一种颜色中 “纯色成分” 的占比 —— 饱和度越高，颜色越鲜艳、纯粹（如正红、纯蓝），**饱和度越低，颜色越接近灰色**
- **明度(luminance/Helligkeit)：** 反映了人眼对颜色反射或发射光强度的感知 —— 明度越高，颜色越接近白色，明度越低，颜色越接近黑色

**HCL** 的核心价值在于 **贴合人类视觉感知逻辑**

**注意：同一个色相可以用明度渐变或者饱和度渐变**
##### 4.3 色彩尺度类型（Farbskalentypen)

- 定性（Qualitativ）：（更适合）**仅用于名义尺度**
- 顺序（Sequentiell）：**至少**用于**序数尺度**
- 发散（Divergierend）：至少用于序数尺度水平，**且存在 “中性的” 中间值**
###### 名义尺度的色彩标度（Farbskalen für nominales Skalenniveau）

- 核心在于确保不同类别之间的**可区分性**，同时保持**各颜色 “显著性” 一致**（即避免某一颜色因视觉效果过强而过度吸引注意力）。
- 通常通过**改变色相（Farbton）** 来区分不同类别，**同时保持饱和度（Sättigung）和明度（Helligkeit）恒定**（需根据人类视觉感知特性进行修正）。
###### 顺序色彩标度（Sequentielle Farbskalen）

- **恒定的色调与饱和度**（konstanter Farbton und Sättigung），仅改变明度
- **多种色调**，饱和度变化且**明度降低**
- **以较低明度编码的值具有最高的显著性**
###### 发散色彩标度（Divergierende Farbskalen）： 

- **两个** 各有 **恒定色调** 的 **顺序尺度** 被组合
- “中性” 中点：尺度的**上下端点具有最高的显著性**

发散色彩标度由**两个顺序色彩标度组合而成**，每个标度分别使用固定的色相，向两端延伸时呈现明度或饱和度的渐变（如一端为蓝色系渐变，另一端为红色系渐变）。

发散色彩标度的典型应用是展示 “**围绕某个中性基准值上下波动**” 的数据
#### 5. 离散特征频率的可视化

##### 5.1 条形图，柱形图和柱状图

- **条形图**（Stabdiagramm）：在 x₁,…,xₙ上分别绘制一条垂直于 x 轴的线（条），高度为 h₁,…,hₙ（或 y₁,…,yₙ）
- **柱形图**（Säulendiagramm）：柱形图与条形图类似，但以矩形代替线条
- **柱状图**（Balkendiagramm）：与柱形图类似，但 x 轴为垂直方向而非水平方向

**应用场景：**

- **名义特征**（问题：特征取值的排列顺序具有任意性！）Nominale Merkmale (Problem: Anordnung der Ausprägungen beliebig!)
- **有序特征**（Ordinale Merkmale）
- **具有少量取值的度量特征**（Metrische Merkmale mit wenigen Ausprägungen）
##### 5.2 堆叠图（Stapeldiagramm）

- 堆叠图以长度呈现绝对频率或相对频率，图中的各个分段 **相互堆叠且用不同颜色区分**
- 以不同长度（宽度）的分段呈现绝对频率或相对频率
- **特别适合通过并排的堆叠组对比不同群体**，即：给定群体下的条件频率

- **名义特征**（但需注意：分段的排列顺序存在争议！）
- **分组数据**（Gruppierte Daten）
- **有序特征** （Ordinale Merkmale）
##### 5.3 环形图（Tortendiagramm），饼图（Kreisdiagramm）

- 通过圆形面积的占比来呈现相对频率或绝对频率
- 缺点：**通过长度呈现数据的效果远优于通过角度
#### 6. 频率与分布的可视化

注意，这个章节重点在**“分布”**的可视化
##### 6.1 点图

- **一维点图**（Eindimensionales Streudiagramm）：将单个观测值以点（圆点）的形式沿轴展示
- **分组点图**（Gruppierter Dotplot）：分组点图是一维散点图的扩展形式，通过将数据按某一条件特征分组，在同一坐标系中用不同位置或颜色的点分别展示各组的观测值，便于直观比较组间分布差异
- **条件分布点图**（Dotplot für bedingte Verteilungen）：y 位置：条件特征的取值，用于条件分布（Dotplot für bedingte Verteilungen）
- **散点图**（Streudiagramm）

**美学元素：**
	- x 位置：通过沿轴分布的点（或其他符号）来呈现单个观测值

点图能直观展示数据的**分布范围、集中趋势及异常值**，尤其适合呈现**少量观测值**的具体取值
当**加入条件特征（如按类别划分 y 轴）时**，还可对比**不同组内的特征分布差异**，兼具简洁性与信息密度。
##### 6.2 直方图（Histogramm）

适用于至少为 **间隔尺度** 的频率分布的图表类型，通过面积来呈现相对频率（面积保真原则）  

**步骤：**

1. 划分组距（Aufteilung in Klassen）bj
2. 确定 **组频率**（Klassenhäufigkeit，每个组内包含的原始数据个数）  $n_j$  和 **相对频率**（relative Häufigkeit） $f_j = \frac{n_j}{n}$（组频率除以总样本量）
3. 确定直方图的高度 $y_j$ ：$b_j \cdot y_j = f_j$，其中 $b_j$ 为第 j 组的组距

**特点：**

- 面积保真的呈现方式类似于密度函数（Dichtefunktionen）的理念，直方图是密度的分段恒定近似
- 仅对**度量数据**有意义（nur bei metrischen Daten sinnvoll）
- 在组距不同的情况下，对柱形高度的解释并不恰当，为了便于解释，**应避免使用不同的组距**
- **缺点**：视觉效果取决于组距（Visueller Eindruck von Klassenbreite abhängig）
- **适用数据类型**：  
    仅对 **度量数据**（metrische Daten）有意义，因为其横轴需为**连续或有序**的数值尺度。

直方图是用于展示至少为**区间尺度**数据频率分布的图形类型，通过**面积**来呈现**相对频率**（遵循 “面积真实性原则”）。
#### 7. 核密度估计（Kerndichteschätzung）

直方图是分段恒定的函数，最大问题是直方图的结果取决于组距的选择，**可以改进位：用平滑函数 $f$ 替代直方图**

**核函数（Kernfunktion）是一种用于描述单个数据点对周围区域影响程度的函数， $k(u)$ 满足：**

- $k(u) >= 0$
- 对于任一的 $u$，核函数在正负无穷区间积分值等于 1 

**核密度估计器（Kerndichteschätzer， KDE）：** $f(x) = \frac{1}{nh}\Sigma_{i=1}^{n}k(\frac{x - x_i}{h})$

- n - 样本总数
- h - **带宽**，h 越大，密度曲线越平滑；h 越小，曲线越接近数据点的分布（可能更粗糙）
- x - 自变量
- $x_i$ - 样本第 i 个观测值

**常用核函数：**

- 高斯核（Gauß-Kern）
- 埃潘涅奇科夫核（Epanechnikov-Kern）
- 三角形核（Dreieck-Kern）

每个数据点通过核函数对周围区域产生影响（影响范围由带宽h控制），最终的密度值是所有数据点影响的平均

**例子**：

假设我们有 5 个数据点：x_1 = 1, x_2 = 2, x_3 = 3, x_4 = 4, x_5 = 5（即 n=5），选择 **矩形核函数**（最简单的核函数之一），并设置带宽 h=1 

**矩形核函数**：k(u) = 1/2，如果 |u| < 1，否则 k(u) = 0

计算 x = 3处的密度估计值 f(3)：

1. 对于每一个数据点计算 $u_i = \frac{x - x_i}{h} = \frac{3 - x_i}{1} = 3 - x_i$
	- $u_1 = 3 - 1 = 2$
	- $u_2 = 3 - 2 = 1$
	- $u_3 = 3 - 3 = 0$
	- $u_4 = 3 - 4 = -1$
	- $u_5 = 3 - 5 = -2$
2. 根据矩形核函数定义，确定k(u)
	- $k(u_1) = k(2) = 0$
	- $k(u_2) = k(1) = 1/2$
	- $k(u_3) = k(0) = 1/2$
	- $k(u_4) = k(-1) = 1/2$
	- $k(u_5) = k(-2) = 0$
3. 代入核密度估计函数KDE，得到$f(3) = 0.3$
4. 结论：在 x=3 处，通过矩形核 （h=1）估计的密度值为 0.3


注意：当数据量较大时，核密度估计在计算每个点的密度值时，**确实需要对所有数据点进行计算**，这是因为核密度估计的本质是 “**每个数据点通过核函数对目标点产生影响，再汇总所有影响**”，可以通过一些优化算法进行优化

**核密度估计优点：** 它考虑了点之间的距离，距离越远权重越低

- 直方图不考虑观测值是位于组的中心还是边缘，**只统计组限范围内的观测值数量**  
- 核密度估计则**会考虑邻近点的距离，且权重随距离的增加而减小**

**带宽的影响**，带宽 h 是核密度估计的关键参数：

- 带宽**过小**：曲线过于敏感，呈现“**过拟合**”
- 带宽**过大**：曲线过于平滑，**丢失细节**

总结：

- 根据数据确定 **带宽** 大小
- 对核函数选择的依赖性**相对不重要**
- 尤其在数据量较大且（准）连续特征的情况下，核密度估计比直方图更值得优先选择
- 核密度估计总是比具有不同组距的直方图更值得优先选择
#### 8. 双变量度量数据（Bivariate metrische Daten）

**问题引出**：存在两个度量特征的数据，数据对 $(x_i,y_i) = 1,...,n$ 

- 这些特征之间是否存在关联？
- 这种关联如何描述？
- 这些特征的联合分布是怎样的？
- 最简单的图形表示：**散点图**
- 数据对对应平面上的点（“**点云**”）(Punktwolke)

**针对较大数据量的展示方式：**
- **使用半透明**（halbdurchsichtigen）—— 以避免重叠绘制（Overplottingvermeiden）
- 使用**尺寸较小的符号**（kleineren Symbolen）效果更佳 —— 以避免重叠绘制（Overplottingvermeiden）
- **通过颜色**（例如明度的变化）直接代替数量 / 密度
- **六边形箱线图**：将散点图的平面划分为等大的六边形网格（而非正方形），用颜色深浅表示每个网格内的点数量（密度）-- hexbin-Plots
- **二维核密度图**：类似单变量核密度估计的扩展，通过对每个数据点应用二维核函数（如二维高斯核），叠加后生成平滑的密度曲面，再用颜色梯度（如从蓝到红）表示密度高低 -- 2D-Kerndichte
#### 9. 德语单词

- Achsen（坐标轴）
- Annotationen（注释）
- additive Farbräume（加色混合色彩空间）
- Ästhetiken（美学特征）
- Ästhetischen Eigenschaften（美学特征）
- Balkendiagramm（柱状图）
- bedingte Verteilungen（条件分布）
- CMYK（青 - 品红 - 黄 - 黑）
- chroma（彩度）
- Dichtefunktionen（密度函数）
- Detektion（识别）
- divergierend（发散）
- Dotplot（点图）
- Eindimensionales Streudiagramm（一维点图）
- Evaluation（评估）
- Epanechnikov-Kern（埃潘涅奇科夫核）
- Farbskalen（颜色尺度）
- Farbton（色相）
- Farbräume（色彩空间）
- Flächen（面积）
- Gauß-Kern（高斯核）
- Geometrien（几何元素）
- geometrischer Objekte（几何对象）
- Grammatik（语法）
- Grammar of Graphics（图形语法）
- Gruppierte Daten（分组数据）
- Gruppierter Dotplot（分组点图）
- Helligkeit（明度）
- hexbin-Plots（六边形箱线图）
- Histogramm（直方图）
- HCL（色相 - 彩度 - 明度）
- hue（色相）
- Lab（明度 - a 轴 - b 轴）
- Längen（长度）
- line style（线型）
- line width（线宽）
- logarithmische（对数坐标系）
- luminanc（明度）
- Map（地图）
- metrische Daten（度量数据）
- multivariate（多变量的）
- Ordinale Merkmale（有序特征）
- Overplotting（点重叠）
- Polarkoordinatensysteme（极坐标系）
- Position（位置）
- Punktwolke（点云）
- Qualitativ（定性）
- Reihenfolge（排列）
- RGB（红 - 绿 - 蓝）
- Rot-Grün-Sehschwäche（红绿色觉缺陷）
- Säulendiagramm（柱形图）
- saturation（饱和度）
- Sehschwächen（视觉缺陷）
- Sequentiell（顺序）
- shape（形状）
- size（大小）
- Skalen（标度）
- Stapeldiagramm（堆叠图）
- Steigung（斜率）
- Streudiagramm（散点图）
- Stabdiagramm（条形图）
- Synthese（整合）
- Theme（主题）
- Tortendiagramm（环形图）
- value（明度）
- Volumen（体积）
- Wahrnehmungseinheitlichkeit（感知的一致性）
- Wellenlänge（波长）
- 2D-Kerndichte（二维核密度图）
### 作业题中知识点

- 变量类型及**测量尺度的识别**：
	- 名义：只分类不排序
	- 顺序：**能排序**，差值无意义（如满意度）
	- 间隔：**可算差值**，人为零点（如温度）
	- 比例：真零值，**可算倍数**（如身高）
	- 绝对：自然固定的计数单位，**不可进行尺度转换**（如人数）
- 变量与图形**美学属性的映射**：
	- 位置（垂直 / 水平）
    - 颜色
    - 大小
    - 形状
    - 线宽
    - 线型
- **配色原则**
	- 名义尺度的色彩标度
	- 顺序尺度的色彩标度
		- 固定色相，饱和度不同
		- 多个色相，明度和饱和度不同
		- 低明度具有显著性
	- 发散尺度的色彩标度
- **失真问题**
- **信息紧凑性与清晰性**
- **图表类型的选择**
	- 柱状图：
		- 优点：结构简单，易于理解，直观展示类别间的数量比较
		- 缺点：排列顺序具有随意性，难以有效展示多变量关系
	- 堆积图：
		- 优点：能同时展示整体和部分的占比关系，适合比较不同群体的条件频率
		- 缺点：分段的排列顺序存在争议，当分类过多时，色彩区分困难
	- 箱线图：
		- 优点：异常值识别，展示数据的中心趋势，即使数据量很大，也能保持图形简洁性
		- 缺点：无法展示数据 “众数数量 / 具体值”（如 bimodal 特征被掩盖 ），仅呈现分位数和极值，**丢失频次细节**
	- 散点图：
		- 优点：直观展示两个度量变量间的关系，能清晰呈现相关性、聚类和异常点，可通过颜色、形状等视觉元素增加更多维度
		- 缺点：大量数据时出现重叠问题，需使用半透明且尺寸较小的符号缓解重叠，可通过颜色、形状等视觉元素增加更多维度
	- 饼图，环形图：
		- 优点：直观展示部分与整体的关系，对少量类别（≤5个）的占比有直观效果
		- 缺点：难以精确比较不同部分的大小，无法正确体现有序特征的顺序关系
	- 直方图：
		- 优点：能直观展示分布形态，是密度函数的分段恒定近似
		- 缺点：严重依赖于类别宽度和边界的选择
- **Grammar of Graphics 框架**
	- 将图表分为数据（data）
	- 美学属性（aesthetics）
	- 几何形式（geometry）
	- 统计变换（statistical transformations）
	- 分面（facets）等组件
- **改进图表的能力**
	- 数据点重叠：散点图用透明度
	- 配色不合理：杂乱，可以同一个色度不同饱和度/明度
	- 装饰性元素过多
	- 标签不清晰等
	- 无序