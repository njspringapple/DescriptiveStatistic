
#### 1. 定义

一个Copula $C:[0,1]^n \rightarrow [0,1]$ 是一个 n 维分布函数， $C(u_1,...,u_2) := P(U_1 < u_1,...,U_n < u_n)$, 其中定义在 $[0,1]^n$ 上，所有 n 个边缘分布的都是标准均匀分布 U[0,1]

- $C(u_1,...,u_n)$ 在每个分量 $u_j$ 上都是**单调递增的**
- 第 j 个分量的边缘分布可以通过设置 uᵢ = 1(对所有i ≠ j) 得到，因为它是均匀分布，所以必须满足：C(1,...,1,uⱼ,1,...,1) = uⱼ

它是一种特殊的多元分布函数，用于描述随机变量之间的依赖结构。Copula的核心特点是它将多元分布函数分解为各自的边缘分布和描述依赖结构的联结函数，使得研究随机变量间的依赖关系变得更加灵活。

又很多Copula函数：

- 独立Copula (Product Copula) ： C(u₁, ..., uₙ) = u₁ × u₂ × ... × uₙ = ∏ᵢ₌₁ⁿ uᵢ
- 高斯Copula：C(u₁, ..., uₙ) = Φₙ(Φ⁻¹(u₁), ..., Φ⁻¹(uₙ); R)
- 。。。



#### 2. 通过Copula和边缘分布构造分布

设C(u₁,...,uₙ)是一个Copula，F₁,...Fₙ是任意一维分布函数。那么

F(x₁,...,xₙ) = C(F₁(x₁),...,Fₙ(xₙ))

是一个具有边缘分布函数F₁,...,Fₙ的分布函数。

▶ ℙ(F(X) ≤ u) = u, u ∈ [0,1]对于连续分布函数F，因此F(X) ~ U[0,1]。

▶ 因此也有：C(u₁,...,uₙ) = F(F₁⁻¹(u₁),...,Fₙ⁻¹(uₙ)).


#### 3. Sklar 定理

设F是一个n维分布函数，其边缘分布为F₁,...,Fₙ。则存在一个Copula C，使得定理17.2成立。如果所有边缘分布都是连续的，**则C是唯一的。**

这意味着，每个连续的多元分布都可以分解为其边缘分布函数和其依赖结构（Copula）。

#### 4. 单调变换下的Copula不变性

设X₁,...,Xₙ是具有连续边缘分布和Copula Cₓ的实值随机变量。设g₁:ℝ→ℝ, i=1,...,n是**严格单调递增**函数，且Y₁=g₁(X₁)。那么Y₁,...,Yₙ的Copula Cᵧ满足：Cᵧ = Cₓ.

这个定理阐述了Copula的一个重要性质：**不变性原则**。它表明，当我们对随机变量进行严格单调递增变换时，得到的新随机变量的依赖结构（由Copula描述）保持不变。

这一性质的实际意义非常深远：

1. **尺度不变性**：我们可以对数据进行任何严格递增的变换（如线性变换、对数变换、指数变换等），而不会改变变量之间的依赖结构。
    
2. **应用灵活性**：在建模过程中，我们可以自由选择最适合每个变量的边缘分布，而不必担心这会影响依赖结构的表达。
    
3. **数据预处理**：在实际应用中，我们常需要对数据进行各种变换（如标准化、排序等），这个定理保证了这些操作不会改变变量间的基本依赖关系。
    

这正是Copula方法的核心优势之一：它将边缘分布和依赖结构完全分离，使我们能够单独处理这两个方面。

#### 5. Fréchet-Hoeffding 边界

对于任何有效的 Copula C(u₁,...,uₙ)，必须满足：

max(1-n+∑ᵢ₌₁ⁿuᵢ, 0) ≤ C(u₁,...,uₙ) ≤ min(u₁,...,uₙ)

▶ 上边界被称为共单调 Copula。例如，当所有Xᵢ（i>1）都是X₁的单调变换时，就会出现这种情况。（"完全正相关依赖"）

▶ 对于n>2，下边界不是有效的Copula。对于n=2，它通过(X,1-X)的联合分布产生，其中X~U[0,1]。（"完全负相关依赖"）

▶ 在独立性条件下，Copula为C(u₁,...,uₙ)=∏ᵢ₌₁ⁿuᵢ。


#### 6. 高斯Copula

设 X = (X₁, X₂) ~ N₂(0, R) 是具有相关矩阵 R = (1 ρ; ρ 1) 的二维正态分布。则：

F_X₁,X₂(x₁, x₂) = Φ_R(x₁, x₂)  
= Φ_R(Φ⁻¹(u₁), Φ⁻¹(u₂))  
= C_R^Ga(u₁, u₂)

其中，Φ_R 是 N₂(0, R) 的分布函数。  
C_R^Ga 称为**高斯Copula**。  
对于 ρ = -1, 0, 1，分别得到完全负相关依赖的Copula、独立Copula和共单调Copula。

